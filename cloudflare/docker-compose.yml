services:
    cloudflare:
        image: cloudflare/cloudflared:latest
        container_name: cloudflare
        restart: unless-stopped
        command: tunnel --no-autoupdate run --token ${CLOUDFLARE_TUNNEL_TOKEN}
        volumes:
            - /etc/localtime:/etc/localtime:ro
        # 若需要自訂名稱解析，用這個，不要覆蓋 /etc/hosts
        # extra_hosts:
        #   - "nginxwebui.local:192.168.25.101"
        healthcheck:
            test:
                - CMD
                - cloudflared
                - --version
            interval: 30s
            timeout: 10s
            retries: 3
            start_period: 10s
        labels:
            - com.centurylinklabs.watchtower.enable=true
    watchtower:
        image: containrrr/watchtower:latest
        container_name: watchtower
        restart: unless-stopped
        volumes:
            - /var/run/docker.sock:/var/run/docker.sock
        command: --cleanup --interval 300
networks: {}
